<!--Apple iOS Style 字帖生成器 主页面-->
<import src="../../styles/apple-design-system.wxss"/>

<view class="ios-page">
  <!-- iOS Style Navigation Bar -->
  <view class="ios-navbar">
    <view class="ios-navbar-title">{{appTitle}}</view>
  </view>

  <view class="ios-container">
    <!-- Hero Section with iOS Gradient -->
    <view class="hero-section ios-gradient-ocean ios-card-large">
      <view class="hero-content">
        <view class="hero-icon">🎨</view>
        <view class="hero-title ios-title-2">{{appTitle}}</view>
        <view class="hero-subtitle ios-body">专业的中文书法练习字帖生成工具</view>
      </view>
    </view>

    <!-- Current Selection Card -->
    <view wx:if="{{selectedTemplate || customText}}" class="ios-section">
      <view class="ios-card ios-glass">
        <view class="selection-header">
          <view class="selection-icon">✅</view>
          <view class="selection-title ios-headline">当前选择</view>
        </view>
        
        <view wx:if="{{selectedTemplate}}" class="selected-template">
          <view class="template-card ios-glass">
            <view class="template-header">
              <view class="template-badge ios-button-secondary">模板</view>
              <view class="template-name ios-callout">{{selectedTemplate.title}}</view>
            </view>
            <view class="template-preview ios-footnote">{{selectedTemplate.content}}</view>
            <view class="template-desc ios-caption">{{selectedTemplate.description}}</view>
          </view>
        </view>
        
        <view wx:if="{{customText && !selectedTemplate}}" class="selected-custom">
          <view class="custom-card ios-glass">
            <view class="custom-header">
              <view class="custom-badge ios-button-secondary">自定义</view>
              <view class="custom-count ios-footnote">{{customText.length}} 字符</view>
            </view>
            <view class="custom-preview ios-callout">{{customText}}</view>
          </view>
        </view>
      </view>
    </view>

    <!-- Quick Actions - iOS Control Center Style -->
    <view class="ios-section">
      <view class="ios-section-header">快速操作</view>
      <view class="quick-actions-grid">
        <view class="action-card ios-glass ios-bounce" bind:tap="openTemplateLibrary">
          <view class="action-icon ios-gradient-blue">📚</view>
          <view class="action-title ios-subhead">精选模板</view>
          <view class="action-desc ios-caption">100+ 书法模板</view>
        </view>
        
        <view class="action-card ios-glass ios-bounce" bind:tap="showCustomInput">
          <view class="action-icon ios-gradient-purple">✏️</view>
          <view class="action-title ios-subhead">自定义创建</view>
          <view class="action-desc ios-caption">输入任意文字</view>
        </view>
        
        <view class="action-card ios-glass ios-bounce" bind:tap="onFeatureClick" data-index="2">
          <view class="action-icon ios-gradient-sunrise">🎭</view>
          <view class="action-title ios-subhead">字体选择</view>
          <view class="action-desc ios-caption">多种字体风格</view>
        </view>
        
        <view class="action-card ios-glass ios-bounce" bind:tap="onFeatureClick" data-index="3">
          <view class="action-icon ios-gradient-ocean">📱</view>
          <view class="action-title ios-subhead">便捷分享</view>
          <view class="action-desc ios-caption">一键生成PDF</view>
        </view>
      </view>
    </view>

    <!-- Recent Templates - iOS List Style -->
    <view wx:if="{{recentTemplates.length > 0}}" class="ios-section">
      <view class="ios-section-header">最近使用</view>
      <view class="ios-list">
        <view wx:for="{{recentTemplates}}" wx:key="id" 
              class="ios-list-item ios-bounce" 
              bind:tap="onTemplateClick" 
              data-id="{{item.id}}">
          <view class="ios-list-icon ios-gradient-blue">
            <text class="template-icon">📝</text>
          </view>
          <view class="ios-list-content">
            <view class="ios-list-title">{{item.title}}</view>
            <view class="ios-list-subtitle">{{item.description}}</view>
          </view>
          <view class="ios-list-chevron">▷</view>
        </view>
      </view>
    </view>

    <!-- Features Grid - iOS Style -->
    <view class="ios-section">
      <view class="ios-section-header">功能特色</view>
      <view class="features-grid">
        <view wx:for="{{features}}" wx:key="action" 
              class="feature-card ios-card ios-bounce" 
              bind:tap="onFeatureClick" 
              data-index="{{index}}">
          <view class="feature-header">
            <view class="feature-icon">{{item.icon === 'library' ? '📚' : item.icon === 'edit' ? '✏️' : item.icon === 'palette' ? '🎨' : '📱'}}</view>
            <view class="feature-title ios-subhead">{{item.title}}</view>
          </view>
          <view class="feature-desc ios-footnote">{{item.description}}</view>
        </view>
      </view>
    </view>

    <!-- Main Action Button -->
    <view class="main-action">
      <button class="ios-button-primary ios-button-large ios-bounce" 
              bind:tap="startCreate" 
              disabled="{{loading}}">
        <view wx:if="{{loading}}" class="loading-spinner">⏳</view>
        <text wx:else>{{selectedTemplate || customText ? '开始创建字帖' : '选择内容开始创建'}}</text>
      </button>
    </view>
  </view>

  <!-- Custom Input Modal - iOS Style -->
  <view wx:if="{{showCustomInput}}" class="ios-modal">
    <view class="ios-modal-backdrop" bind:tap="{{() => setData({showCustomInput: false})}}"></view>
    <view class="ios-modal-content ios-card-large">
      <view class="modal-header">
        <view class="modal-title ios-headline">输入自定义文字</view>
        <button class="modal-close ios-button-secondary" bind:tap="{{() => setData({showCustomInput: false})}}">
          取消
        </button>
      </view>
      
      <view class="modal-body">
        <textarea class="ios-input custom-textarea" 
                  placeholder="请输入要生成字帖的文字内容..."
                  value="{{customText}}"
                  bind:input="onCustomTextChange"
                  maxlength="500">
        </textarea>
        <view class="input-counter ios-caption">{{customText.length}}/500</view>
      </view>
      
      <view class="modal-footer">
        <button class="ios-button-primary ios-button-large ios-bounce" 
                bind:tap="onCustomTextConfirm"
                disabled="{{!customText.trim()}}">
          确认使用
        </button>
      </view>
    </view>
  </view>
</view>