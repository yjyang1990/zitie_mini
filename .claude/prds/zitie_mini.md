# PRD: zitie_mini - 字帖生成小程序

**Created:** 2025-09-13  
**Status:** Draft  
**Priority:** High  
**Project Type:** WeChat Mini-Program
**Prototype:** `/Users/yyj/WeChatProjects/zitie_mini/prototype`
**Project Status:** 已清理TDesign演示文件，初始化干净的小程序项目结构

## Overview

### Problem Statement
传统书法练习缺乏个性化定制，学习者难以找到适合自己水平和需求的字帖。现有的字帖生成工具功能单一，用户体验不佳，缺乏智能化的练习指导和进度跟踪功能。

### Solution Summary
开发一款智能化的字帖生成微信小程序，支持个性化字帖创建、多种书法字体选择、练习进度跟踪、模板管理等功能。通过现代化的UI设计和用户体验，让传统书法练习更加便捷和高效。

## Requirements

### Functional Requirements

1. **核心功能模块**
   - [ ] 字帖内容创建和编辑
   - [ ] 多种书法字体支持（楷书、行书、隶书等）
   - [ ] 字帖格式自定义（田字格、米字格、方格等）
   - [ ] 文字输入和智能排版
   - [ ] 字帖预览和实时编辑

2. **TDesign UI组件系统**
   - [ ] **基础组件集成**：
     - Button (按钮)、Input (输入框)、Textarea (文本域)
     - Dialog (对话框)、Toast (轻提示)、Loading (加载)
     - Picker (选择器)、Slider (滑块)、Switch (开关)
   - [ ] **导航组件**：
     - Navbar (导航栏)、TabBar (标签栏)、Steps (步骤条)
   - [ ] **展示组件**：
     - Grid (网格)、Cell (单元格)、Card (卡片)
     - Avatar (头像)、Badge (徽章)、Tag (标签)
   - [ ] **反馈组件**：
     - Progress (进度条)、Result (结果页)、Empty (空状态)
   - [ ] **自定义主题色彩**：
     - 智慧蓝主题 (#5B8DEE)
     - 中式传统色彩配置
     - 夜间模式支持

3. **高级功能模块**
   - [ ] **模板系统**：
     - 预设模板库（古诗、成语、课本内容）
     - 用户自定义模板创建和分享
     - 模板排行和评分系统
   - [ ] **作品管理**：
     - 历史记录和云端同步
     - 批量操作和文件管理
     - 作品状态管理（生成中、已完成、失败）
   - [ ] **社交互动**：
     - 作品分享到社区
     - 点赞、评论、收藏功能
     - 用户关注和私信系统
   - [ ] **AI智能功能**：
     - AI书法评测和指导
     - 智能练习建议
     - 个性化学习路径推荐

### Non-Functional Requirements

1. **性能要求**
   - 首页加载时间: < 2s
   - 字帖生成时间: < 3s (单页A4字帖)
   - Canvas渲染帧率: ≥ 30fps
   - 小程序包大小: < 8MB (包含基础字体)
   - 字体文件加载: 按需加载，单个字体 < 2MB

2. **技术兼容性**
   - **小程序版本**：支持微信基础库 3.0+
   - **系统兼容**：iOS 12+、Android 8.0+
   - **屏幕适配**：320px-428px宽度，高度自适应
   - **TDesign组件**：支持Skyline和普通渲染模式
   - **字体格式**：TTF/OTF/WOFF2多格式兼容

3. **用户体验要求**
   - **操作流程**：3步完成字帖创建流程
   - **无障碍支持**：TDesign组件原生无障碍支持
   - **离线功能**：本地缓存常用字体和模板
   - **触觉反馈**：关键操作的触觉反馈支持
   - **热更新**：小程序热更新机制支持

## User Stories

### 主要用户流程

1. **字帖创建流程**
   ```
   Given: 用户进入小程序
   When: 用户点击"创建字帖"
   Then: 系统显示创建界面，用户可输入文字、选择字体和格式
   And: 用户完成设置后可预览和保存字帖
   ```

2. **模板使用流程**
   ```
   Given: 用户在模板页面
   When: 用户选择预设模板
   Then: 系统加载模板内容，用户可进行个性化修改
   ```

3. **历史记录管理**
   ```
   Given: 用户有历史创建记录
   When: 用户访问历史页面
   Then: 系统显示历史字帖列表，支持查看、编辑、删除操作
   ```

## Technical Considerations

### 技术依赖

#### 基础框架
- **微信小程序框架** - 原生小程序开发
- **TDesign 小程序组件库** - 企业级UI组件库（待集成）
- **Skyline渲染引擎** - 微信小程序新一代渲染引擎支持

#### 核心技术
- **Canvas API** - 字帖渲染和精细绘制
- **云开发数据库** - 用户数据和作品存储
- **中文书法字体库** - 多种书法字体支持
- **PDF.js/Canvas2PDF** - PDF生成和导出功能

#### 特色功能技术
- **拼音字典API** - 中文拼音标注功能
- **字体子集化技术** - 按需加载优化性能
- **增强现实 (AR)** - 未来书法练习指导

### 风险与缓解措施
1. **风险:** 字体文件大小影响加载性能
   - **缓解:** 使用字体子集化技术，按需加载所需字符

2. **风险:** Canvas渲染性能在低端设备上的表现
   - **缓解:** 实现渐进式渲染和性能优化策略

3. **风险:** 用户数据的隐私保护
   - **缓解:** 遵循最小化数据收集原则，本地优先存储

### 实现方案

#### 技术架构路径
- [ ] **Phase 1**: 技术框架搭建
  - TDesign组件库集成和主题定制
  - 微信小程序项目初始化
  - Skyline渲染引擎配置
  
- [ ] **Phase 2**: 核心功能开发
  - Canvas字帖渲染引擎实现
  - 字体管理和加载系统
  - 基础字帖创建功能
  
- [ ] **Phase 3**: 高级功能实现
  - 模板系统和社区功能
  - AI智能评测集成
  - 性能优化和缓存策略
  
- [ ] **Phase 4**: 测试与上线
  - 自动化测试和E2E测试
  - 性能监控和用户体验优化
  - 微信小程序审核和发布

## Acceptance Criteria

### 完成标准
- [ ] 所有功能模块实现并通过测试
- [ ] UI/UX设计与原型一致
- [ ] 所有页面在不同设备上显示正常
- [ ] 性能指标达到预期目标
- [ ] 通过微信小程序审核
- [ ] 用户手册和帮助文档完成

### 测试策略
- [ ] 单元测试 (关键逻辑模块)
- [ ] 集成测试 (数据流和接口调用)
- [ ] 端到端测试 (用户操作流程)
- [ ] 性能测试 (不同设备和网络环境)
- [ ] 兼容性测试 (微信各版本)

## Metrics & Success Criteria

### 关键性能指标 (KPI)
- 日活跃用户数: 目标100+
- 字帖生成成功率: >95%
- 用户留存率: 七日留存>60%
- 页面加载时间: <2秒

### 成功指标
- **用户满意度**: 小程序商店评分 >4.5/5.0
- **功能使用率**: 核心字帖创建功能 >90%
- **性能表现**: 字帖生成时间 <3秒
- **社交互动**: 作品分享率 >25%
- **用户留存**: 30日留存率 >40%
- **TDesign组件**: 组件覆盖率 >95%，自定义组件 <10%

## Timeline

### 里程碑
- **第1-2周:** 项目初始化和技术选型
- **第3-4周:** 基础框架和UI组件开发
- **第5-6周:** 字帖生成核心功能开发
- **第7-8周:** 高级功能和集成测试
- **第9-10周:** 性能优化和用户测试
- **第11-12周:** 上线准备和发布

### 工作量估算
- 开发: 45-50个人日
- 测试: 10-15个人日
- UI/UX设计: 8-10个人日
- 文档和上线: 5-8个人日

---

## 原型设计分析结果

### 原型设计亮点

#### 1. **UI/UX设计优势**
- **完整的设计系统**: 定义了完整的色彩、字体、间距规范
- **中式传统元素**: 字帖文化与现代UI的完美融合
- **响应式设计**: 适配多种屏幕尺寸的小程序界面

#### 2. **交互体验优化**
- **直观的操作流程**: 3步完成字帖制作的简化设计
- **实时反馈**: 编辑即时预览，参数调整即时生效
- **智能化操作**: 拼音自动标注、快速模板选择

#### 3. **功能丰富度**
- **全面的参数控制**: 从字体大小到网格类型的精细设置
- **社区互动**: 作品分享、点赞评论的完整社区系统
- **AI智能助手**: 书法评测和个性化学习建议

### 技术实现建议

#### 1. **项目现状与技术选型**
**现状**: 已清理TDesign演示文件，初始化干净的小程序项目  
**技术方案**: 集成TDesign组件库，结合原型设计实现字帖生成功能

**TDesign集成优势**:
- 企业级组件质量和稳定性
- 完整的无障碍支持
- 丰富的组件生态和文档
- 微信小程序原生支持
- 现有干净项目结构，不需迁移成本

#### 2. **渲染方案优化**
**现状**: CSS Grid + HTML实现  
**建议**: 混合架构 - TDesign UI + Canvas渲染

**实施策略**:
- **界面层**: TDesign组件实现交互界面
- **渲染层**: Canvas API实现字帖精细渲染
- **数据层**: 微信云开发存储和同步

### 开发优先级调整

#### P0 (必须实现)
1. **TDesign组件集成**: 安装和配置TDesign小程序组件库
2. **核心字帖功能**: 基于原型设计实现Canvas渲染引擎
3. **基础用户流程**: 参考prototype设计实现创建、预览、导出流程

#### P1 (重要功能)
1. **模板系统**: 预设模板和用户自定义模板
2. **高级设置**: 精细参数控制和专业功能
3. **云存储同步**: 作品管理和历史记录

#### P2 (增强功能)
1. **社区互动**: 作品分享、点赞评论系统
2. **AI智能功能**: 书法评测和个性化建议
3. **会员系统**: 高级字体和专业功能解锁

## 项目清理和重构结果

### 已完成的清理工作

#### 清理内容
- ✅ **删除TDesign演示页面**: 清理了16+个组件演示页面
- ✅ **清理组件库文件**: 删除components、behaviors、demos目录
- ✅ **删除测试文件**: 清理tests、utils、assets目录
- ✅ **保留核心文件**: 保留prototype目录和.claude配置

#### 新项目结构
```
zitie_mini/
├── .claude/                    # CCPM项目管理配置
├── prototype/                  # 原型设计文件
├── pages/
│   └── index/                  # 小程序首页
├── app.js                      # 小程序入口文件
├── app.json                    # 小程序全局配置
├── app.wxss                    # 全局样式（含设计系统）
└── project.config.json         # 小程序项目配置
```

#### 初始化的基础功能
- ✅ **干净的首页**: 基于原型设计的欢迎页面
- ✅ **设计系统**: 在app.wxss中定义了完整的色彩系统
- ✅ **原型保留**: 完整保留了prototype目录作为设计参考
- ✅ **CCPM集成**: 保留了完整的项目管理框架

---

**Next Steps:**
1. **安装TDesign**: `npm install tdesign-miniprogram`
2. **生成Epic任务**: `/pm:prd-parse zitie_mini`
3. **开发环境搭建**: TDesign组件库集成和主题定制
4. **功能实现**: 基于prototype设计开发字帖生成功能
