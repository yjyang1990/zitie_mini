<!--Apple iOS Style å­—å¸–ç”Ÿæˆå™¨ ä¸»é¡µé¢-->
<import src="../../styles/apple-design-system.wxss"/>

<view class="ios-page">
  <!-- iOS Style Navigation Bar -->
  <view class="ios-navbar">
    <view class="ios-navbar-title">{{appTitle}}</view>
  </view>

  <view class="ios-container">
    <!-- Hero Section with iOS Gradient -->
    <view class="hero-section ios-gradient-ocean ios-card-large">
      <view class="hero-content">
        <view class="hero-icon">ğŸ¨</view>
        <view class="hero-title ios-title-2">{{appTitle}}</view>
        <view class="hero-subtitle ios-body">ä¸“ä¸šçš„ä¸­æ–‡ä¹¦æ³•ç»ƒä¹ å­—å¸–ç”Ÿæˆå·¥å…·</view>
      </view>
    </view>

    <!-- Current Selection Card -->
    <view wx:if="{{selectedTemplate || customText}}" class="ios-section">
      <view class="ios-card ios-glass">
        <view class="selection-header">
          <view class="selection-icon">âœ…</view>
          <view class="selection-title ios-headline">å½“å‰é€‰æ‹©</view>
        </view>
        
        <view wx:if="{{selectedTemplate}}" class="selected-template">
          <view class="template-card ios-glass">
            <view class="template-header">
              <view class="template-badge ios-button-secondary">æ¨¡æ¿</view>
              <view class="template-name ios-callout">{{selectedTemplate.title}}</view>
            </view>
            <view class="template-preview ios-footnote">{{selectedTemplate.content}}</view>
            <view class="template-desc ios-caption">{{selectedTemplate.description}}</view>
          </view>
        </view>
        
        <view wx:if="{{customText && !selectedTemplate}}" class="selected-custom">
          <view class="custom-card ios-glass">
            <view class="custom-header">
              <view class="custom-badge ios-button-secondary">è‡ªå®šä¹‰</view>
              <view class="custom-count ios-footnote">{{customText.length}} å­—ç¬¦</view>
            </view>
            <view class="custom-preview ios-callout">{{customText}}</view>
          </view>
        </view>
      </view>
    </view>

    <!-- Quick Actions - iOS Control Center Style -->
    <view class="ios-section">
      <view class="ios-section-header">å¿«é€Ÿæ“ä½œ</view>
      <view class="quick-actions-grid">
        <view class="action-card ios-glass ios-bounce" bind:tap="openTemplateLibrary">
          <view class="action-icon ios-gradient-blue">ğŸ“š</view>
          <view class="action-title ios-subhead">ç²¾é€‰æ¨¡æ¿</view>
          <view class="action-desc ios-caption">100+ ä¹¦æ³•æ¨¡æ¿</view>
        </view>
        
        <view class="action-card ios-glass ios-bounce" bind:tap="showCustomInput">
          <view class="action-icon ios-gradient-purple">âœï¸</view>
          <view class="action-title ios-subhead">è‡ªå®šä¹‰åˆ›å»º</view>
          <view class="action-desc ios-caption">è¾“å…¥ä»»æ„æ–‡å­—</view>
        </view>
        
        <view class="action-card ios-glass ios-bounce" bind:tap="onFeatureClick" data-index="2">
          <view class="action-icon ios-gradient-sunrise">ğŸ­</view>
          <view class="action-title ios-subhead">å­—ä½“é€‰æ‹©</view>
          <view class="action-desc ios-caption">å¤šç§å­—ä½“é£æ ¼</view>
        </view>
        
        <view class="action-card ios-glass ios-bounce" bind:tap="onFeatureClick" data-index="3">
          <view class="action-icon ios-gradient-ocean">ğŸ“±</view>
          <view class="action-title ios-subhead">ä¾¿æ·åˆ†äº«</view>
          <view class="action-desc ios-caption">ä¸€é”®ç”ŸæˆPDF</view>
        </view>
      </view>
    </view>

    <!-- Recent Templates - iOS List Style -->
    <view wx:if="{{recentTemplates.length > 0}}" class="ios-section">
      <view class="ios-section-header">æœ€è¿‘ä½¿ç”¨</view>
      <view class="ios-list">
        <view wx:for="{{recentTemplates}}" wx:key="id" 
              class="ios-list-item ios-bounce" 
              bind:tap="onTemplateClick" 
              data-id="{{item.id}}">
          <view class="ios-list-icon ios-gradient-blue">
            <text class="template-icon">ğŸ“</text>
          </view>
          <view class="ios-list-content">
            <view class="ios-list-title">{{item.title}}</view>
            <view class="ios-list-subtitle">{{item.description}}</view>
          </view>
          <view class="ios-list-chevron">â–·</view>
        </view>
      </view>
    </view>

    <!-- Features Grid - iOS Style -->
    <view class="ios-section">
      <view class="ios-section-header">åŠŸèƒ½ç‰¹è‰²</view>
      <view class="features-grid">
        <view wx:for="{{features}}" wx:key="action" 
              class="feature-card ios-card ios-bounce" 
              bind:tap="onFeatureClick" 
              data-index="{{index}}">
          <view class="feature-header">
            <view class="feature-icon">{{item.icon === 'library' ? 'ğŸ“š' : item.icon === 'edit' ? 'âœï¸' : item.icon === 'palette' ? 'ğŸ¨' : 'ğŸ“±'}}</view>
            <view class="feature-title ios-subhead">{{item.title}}</view>
          </view>
          <view class="feature-desc ios-footnote">{{item.description}}</view>
        </view>
      </view>
    </view>

    <!-- Main Action Button -->
    <view class="main-action">
      <button class="ios-button-primary ios-button-large ios-bounce" 
              bind:tap="startCreate" 
              disabled="{{loading}}">
        <view wx:if="{{loading}}" class="loading-spinner">â³</view>
        <text wx:else>{{selectedTemplate || customText ? 'å¼€å§‹åˆ›å»ºå­—å¸–' : 'é€‰æ‹©å†…å®¹å¼€å§‹åˆ›å»º'}}</text>
      </button>
    </view>
  </view>

  <!-- Custom Input Modal - iOS Style -->
  <view wx:if="{{showCustomInput}}" class="ios-modal">
    <view class="ios-modal-backdrop" bind:tap="{{() => setData({showCustomInput: false})}}"></view>
    <view class="ios-modal-content ios-card-large">
      <view class="modal-header">
        <view class="modal-title ios-headline">è¾“å…¥è‡ªå®šä¹‰æ–‡å­—</view>
        <button class="modal-close ios-button-secondary" bind:tap="{{() => setData({showCustomInput: false})}}">
          å–æ¶ˆ
        </button>
      </view>
      
      <view class="modal-body">
        <textarea class="ios-input custom-textarea" 
                  placeholder="è¯·è¾“å…¥è¦ç”Ÿæˆå­—å¸–çš„æ–‡å­—å†…å®¹..."
                  value="{{customText}}"
                  bind:input="onCustomTextChange"
                  maxlength="500">
        </textarea>
        <view class="input-counter ios-caption">{{customText.length}}/500</view>
      </view>
      
      <view class="modal-footer">
        <button class="ios-button-primary ios-button-large ios-bounce" 
                bind:tap="onCustomTextConfirm"
                disabled="{{!customText.trim()}}">
          ç¡®è®¤ä½¿ç”¨
        </button>
      </view>
    </view>
  </view>
</view>